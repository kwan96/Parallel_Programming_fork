<!DOCTYPE html>
<!-- saved from url=(0052)https://nycu-sslab.github.io/PP-s25/assignments/HW1/ -->
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="./Programming Assignment I _ PP-s25_files/just-the-docs-default.css"> <script async="" src="./Programming Assignment I _ PP-s25_files/js"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-PQKJHD68D8', { 'anonymize_ip': true }); </script> <script src="./Programming Assignment I _ PP-s25_files/lunr.min.js.下載"></script> <script src="./Programming Assignment I _ PP-s25_files/just-the-docs.js.下載"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Programming Assignment I | PP-s25</title><meta name="generator" content="Jekyll v3.10.0"><meta property="og:title" content="Programming Assignment I"><meta property="og:locale" content="en_US"><meta name="description" content="Spring 2025 @ NYCU with Prof. Yi-Ping You"><meta property="og:description" content="Spring 2025 @ NYCU with Prof. Yi-Ping You"><link rel="canonical" href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/"><meta property="og:url" content="https://nycu-sslab.github.io/PP-s25/assignments/HW1/"><meta property="og:site_name" content="PP-s25"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><meta property="twitter:title" content="Programming Assignment I"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Spring 2025 @ NYCU with Prof. Yi-Ping You","headline":"Programming Assignment I","url":"https://nycu-sslab.github.io/PP-s25/assignments/HW1/"}</script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body><div id="MathJax_Message" style="display: none;"></div> <a class="skip-to-main" href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"></path><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"></path> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="https://nycu-sslab.github.io/PP-s25/" class="site-title lh-tight"> PP-s25 </a> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="https://nycu-sslab.github.io/PP-s25/syllabus/" class="nav-list-link">Syllabus</a></li><li class="nav-list-item"><a href="https://nycu-sslab.github.io/PP-s25/schedule/" class="nav-list-link">Schedule</a></li><li class="nav-list-item"><a href="https://nycu-sslab.github.io/PP-s25/project/" class="nav-list-link">Project</a></li><li class="nav-list-item active"><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#" class="nav-list-expander" aria-label="toggle links in Assignments category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="https://nycu-sslab.github.io/PP-s25/assignments/" class="nav-list-link">Assignments</a><ul class="nav-list"><li class="nav-list-item "><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW0/" class="nav-list-link">Programming Assignment ZERO</a></li><li class="nav-list-item active"><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/" class="nav-list-link active">Programming Assignment I</a></li><li class="nav-list-item "><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW2/" class="nav-list-link">Programming Assignment II</a></li><li class="nav-list-item "><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW3/" class="nav-list-link">Programming Assignment III</a></li><li class="nav-list-item "><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW4/" class="nav-list-link">Programming Assignment IV</a></li><li class="nav-list-item "><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW5/" class="nav-list-link">Programming Assignment V</a></li><li class="nav-list-item "><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW6/" class="nav-list-link">Programming Assignment VI</a></li></ul></li><li class="nav-list-item"><a href="https://nycu-sslab.github.io/PP-s25/references/" class="nav-list-link">References</a></li></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search PP-s25" aria-label="Search PP-s25" autocomplete="off" data-sharkid="__0"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="https://e3p.nycu.edu.tw/mod/forum/index.php?id=9875&amp;scope=forum" class="site-button" target="_blank" rel="noopener noreferrer"> E3 Forum </a></li></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://nycu-sslab.github.io/PP-s25/assignments/">Assignments</a></li><li class="breadcrumb-nav-list-item"><span>Programming Assignment I</span></li></ol></nav><div id="main-content" class="main-content" role="main"><h1 id="programming-assignment-i-simd-programming"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#programming-assignment-i-simd-programming" class="anchor-heading" aria-labelledby="programming-assignment-i-simd-programming"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Programming Assignment I: SIMD Programming</h1><p><strong>Parallel Programming by Prof. Yi-Ping You</strong></p><p class="fs-6 fw-300">Due date: <strong>23:59, March 20 Thursday, 2025</strong></p><p>The purpose of this assignment is to familiarize yourself with (single-instruction, multiple-data) SIMD programming. Most modern processors include vector operations (i.e., SIMD instructions) that you can take advantage of to improve performance through vectorization. Although modern compilers support automatic vectorization optimizations, their capabilities to fully auto-vectorize a given piece of code are limited. Fortunately, most compilers (targeted to processors with SIMD extensions) provide SIMD intrinsics to allow programmers to manually vectorize their code.</p><hr><h2 class="no_toc text-delta" id="table-of-contents"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents</h2><ol id="markdown-toc"><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#programming-assignment-i-simd-programming" id="markdown-toc-programming-assignment-i-simd-programming">Programming Assignment I: SIMD Programming</a><ol><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#0-using-workstation" id="markdown-toc-0-using-workstation">0. Using Workstation</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#1-part-1-vectorizing-code-using-fake-simd-intrinsics" id="markdown-toc-1-part-1-vectorizing-code-using-fake-simd-intrinsics">1. Part 1: Vectorizing Code Using Fake SIMD Intrinsics</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#2-part-2-vectorizing-code-with-automatic-vectorization-optimizations" id="markdown-toc-2-part-2-vectorizing-code-with-automatic-vectorization-optimizations">2. Part 2: Vectorizing Code with Automatic Vectorization Optimizations</a><ol><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#21-no-auto-vectorization" id="markdown-toc-21-no-auto-vectorization">2.1 No auto-vectorization</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#22-turning-on-auto-vectorization" id="markdown-toc-22-turning-on-auto-vectorization">2.2 Turning on auto-vectorization</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#23-adding-the-__restrict-qualifier" id="markdown-toc-23-adding-the-__restrict-qualifier">2.3 Adding the <code class="language-plaintext highlighter-rouge">__restrict</code> qualifier</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#24-adding-the-__builtin_assume_aligned-intrinsic" id="markdown-toc-24-adding-the-__builtin_assume_aligned-intrinsic">2.4 Adding the <code class="language-plaintext highlighter-rouge">__builtin_assume_aligned</code> intrinsic</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#25-turning-on-avx2-instructions" id="markdown-toc-25-turning-on-avx2-instructions">2.5 Turning on AVX2 instructions</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#26-performance-impacts-of-vectorization" id="markdown-toc-26-performance-impacts-of-vectorization">2.6 Performance impacts of vectorization</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#27--more-examples" id="markdown-toc-27--more-examples">2.7 More examples</a><ol><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#271-example-2" id="markdown-toc-271-example-2">2.7.1 Example 2</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#272-example-3" id="markdown-toc-272-example-3">2.7.2 Example 3</a></li></ol></li></ol></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#3-requirements" id="markdown-toc-3-requirements">3. Requirements</a><ol><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#31-part-1" id="markdown-toc-31-part-1">3.1 Part 1</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#32-part-2" id="markdown-toc-32-part-2">3.2 Part 2</a></li></ol></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#4-grading-policy" id="markdown-toc-4-grading-policy">4. Grading Policy</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#5-evaluation-platform" id="markdown-toc-5-evaluation-platform">5. Evaluation Platform</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#6-submission" id="markdown-toc-6-submission">6. Submission</a></li><li><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#7-references" id="markdown-toc-7-references">7. References</a></li></ol></li></ol><hr><p>We use the workstations provided by NYCU CSIT for this course. You can access the workstations by <code class="language-plaintext highlighter-rouge">ssh</code> or use your own environment to complete the assignment. (To learn how to use <code class="language-plaintext highlighter-rouge">ssh</code> and <code class="language-plaintext highlighter-rouge">scp</code>, you can refer to the video listed in the <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#7-references">references</a>)</p><div class="table-wrapper"><table><thead><tr><th>Hostname</th><th>IP</th></tr></thead><tbody><tr><td>hpclogin[01-03].cs.nycu.edu.tw</td><td>140.113.17.[101-103]</td></tr></tbody></table></div><p>Login example:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh &lt;username&gt;@hpclogin[01-03].cs.nycu.edu.tw
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><blockquote class="important"><p>Additionally, we have configured the environment for you, which <strong>MUST</strong> be activated before running the assignment code using the following command:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /shared/manifest/guix/profile/pp-env/etc/profile
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>You can leave the environment by typing <code class="language-plaintext highlighter-rouge">exit</code> or pressing <code class="language-plaintext highlighter-rouge">Ctrl-D</code>.</p></blockquote><p>Please download the assignment code and unzip it:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://nycu-sslab.github.io/PP-s25/assignments/HW1/HW1.zip
unzip HW1.zip
<span class="nb">cd </span>HW1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><h2 id="0-using-workstation"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#0-using-workstation" class="anchor-heading" aria-labelledby="0-using-workstation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 0. Using Workstation</h2><p>Our workstations are managed using the Slurm Workload Manager and NFS. After connecting via <code class="language-plaintext highlighter-rouge">ssh</code>, you’ll be placed on the <em>login node</em>. From there, you can submit jobs to the <em>compute nodes</em> using the <code class="language-plaintext highlighter-rouge">run</code> command. Your home directory is shared across all login nodes and compute nodes. Below is an example of how to submit a job to the cluster:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>run <span class="nt">--</span> ./myexp <span class="nt">-s</span> 10000
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><blockquote class="important"><ul><li>It’s important to avoid running your programs directly on the login node, as it has limited resources and is less powerful than the compute nodes. To prevent overloading, we restrict resource usage on the login node. Aside from compiling code, all program execution should occur on the compute nodes.</li><li>The double dash (<code class="language-plaintext highlighter-rouge">--</code>) is required because the run command itself accepts arguments.</li></ul></blockquote><p>If you need to run multiple programs in a row, you can start a shell on the compute node with the following command:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>run <span class="nt">--</span> bash <span class="nt">-c</span> <span class="s2">"./myexp -s 10000 &amp;&amp; ./myexp -s 10000"</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>If your program ever gets stuck, you can use <code class="language-plaintext highlighter-rouge">Ctrl-C</code> to forcefully terminate it, or open a new shell to obtain the job ID with the <code class="language-plaintext highlighter-rouge">squeue</code> command and use the <code class="language-plaintext highlighter-rouge">scancel</code> command to cancel the job:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scancel &lt;your_job_id&gt;
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><blockquote class="note"><ul><li>The <code class="language-plaintext highlighter-rouge">run</code> command is a wrapper script around <code class="language-plaintext highlighter-rouge">sbatch</code>, simplifying job submission to Slurm so that you can execute your program as if running it directly on the login node. If you prefer, you may use sbatch directly, but its usage is outside the scope of this course.</li><li>Since the <code class="language-plaintext highlighter-rouge">run</code> command is provided by the TA, please contact them for any issues or suggestions for improvement.</li></ul></blockquote><p>You can check out <a href="https://man.twcc.ai/@twnia3/SJDW5J3Rv">this</a> user guide of Slurm to learn more about how to use it.</p><h2 id="1-part-1-vectorizing-code-using-fake-simd-intrinsics"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#1-part-1-vectorizing-code-using-fake-simd-intrinsics" class="anchor-heading" aria-labelledby="1-part-1-vectorizing-code-using-fake-simd-intrinsics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Part 1: Vectorizing Code Using Fake SIMD Intrinsics</h2><p>Take a look at <code class="language-plaintext highlighter-rouge">part1/main.cpp</code> in the Assignment I code base. The <code class="language-plaintext highlighter-rouge">clampedExpSerial</code> function raises <code class="language-plaintext highlighter-rouge">values[i]</code> to the power given by <code class="language-plaintext highlighter-rouge">exponents[i]</code> and clamps the result at 9.999999. Your job is to vectorize this code with SIMD vector instructions and implement it in the <code class="language-plaintext highlighter-rouge">clampedExpVector</code> function in <code class="language-plaintext highlighter-rouge">part1/vectorOP.cpp</code>.</p><p>Please enter the <code class="language-plaintext highlighter-rouge">part1</code> folder and compile:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>part1 <span class="o">&amp;&amp;</span> make
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p><strong>Rather than</strong> using <em>SSE</em> or <em>AVX2</em> vector intrinsics that map to SIMD vector instructions on modern CPUs, to make things a little easier, we’re asking you to <strong><em>implement your version using PP’s “fake vector intrinsics” defined in <code class="language-plaintext highlighter-rouge">PPintrin.h</code>.</em></strong> The <code class="language-plaintext highlighter-rouge">PPintrin.h</code> library provides you with a set of vector intrinsic instructions. (These functions don’t translate to real CPU vector instructions, instead, we simulate these operations and provide feedback that makes for easier debugging.)</p><p>As an example of using the PP intrinsics, a vectorized <code class="language-plaintext highlighter-rouge">absVector</code> function is given in <code class="language-plaintext highlighter-rouge">part1/vectorOP.cpp</code>. This example contains basic vector loads/stores and manipulation of mask registers. Note that <code class="language-plaintext highlighter-rouge">absVector</code> is simple and in fact doesn’t correctly handle all inputs! (We will let you figure out why!)</p><p><strong>Hints</strong>:</p><ul><li>You may wish to read through the function definitions in <code class="language-plaintext highlighter-rouge">PPintrin.h</code> to know what operations are available.</li><li>Every vector instruction is subject to a mask parameter. A mask of 0 indicates the corresponding lane will not be overwritten by the operation results. If the operation doesn’t take a mask parameter, all lanes are not masked. (Note: It’s equivalent to providing a mask of all ones.)</li><li>Your solution will use multiple mask registers and various mask operations.</li><li>You might find <code class="language-plaintext highlighter-rouge">_pp_init_ones</code> helpful to initialize masks.</li><li>You might find <code class="language-plaintext highlighter-rouge">_pp_cntbits</code> helpful in this problem.</li><li>Consider cases where loop iterations aren’t a multiple of SIMD vector width. We suggest you test your code with <code class="language-plaintext highlighter-rouge">run -- ./myexp -s 3</code>.</li><li>Use <code class="language-plaintext highlighter-rouge">run -- ./myexp -l</code> to print a log of executed vector instructions at the end. Use the <code class="language-plaintext highlighter-rouge">addUserLog()</code> function to log customized debug information. Feel free to call <code class="language-plaintext highlighter-rouge">PPLogger.printLog()</code> to help you debug.</li><li>You can use <code class="language-plaintext highlighter-rouge">make VECTOR_WIDTH=&lt;number&gt;</code> to change the default vector width, which is set to 4.</li></ul><p>If there are incorrect results, the program will print the first one it finds and print out a table of function inputs and outputs. Your function’s output is after “output = “, which should match with the results after “gold = “. The program also prints out the utilization statistics of the PP fake vector units. You should consider the performance of your implementation related to “Total Vector Instructions”. (You can assume every PP fake vector instruction takes one cycle on the PP fake SIMD CPU.) “Vector Utilization” shows the percentage of vector lanes that are enabled.</p><p>See the <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#3-requirements">requirements</a> to finish this part.</p><blockquote><p>The following part is not required for this assignment, but you are encouraged to do it for practice.</p><p>Once you have finished part 1, it is time to vectorize the code using real SIMD intrinsics and see if the program really benefits from vectorization. Vectorize the same piece of code in part 1 so it can be run on a machine with SIMD vector instructions.</p><p>Intrinsics are exposed by the compiler as (inline) functions that are not part of any library. Of course, the SIMD intrinsics depend on the underlying architecture and may differ across compilers even for the same SIMD instruction set. Fortunately, compilers tend to standardize intrinsic prototypes for a given SIMD instruction set, and we only have to handle the differences between the various SIMD instruction sets.</p></blockquote><h2 id="2-part-2-vectorizing-code-with-automatic-vectorization-optimizations"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#2-part-2-vectorizing-code-with-automatic-vectorization-optimizations" class="anchor-heading" aria-labelledby="2-part-2-vectorizing-code-with-automatic-vectorization-optimizations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Part 2: Vectorizing Code with Automatic Vectorization Optimizations</h2><p>Take the exercises below and answer questions <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#Q2-1">Q2-1</a>, <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#Q2-2">Q2-2</a>, and <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#Q2-3">Q2-3</a>.</p><p>We are going to start from scratch and make the compiler do the brunt of the work. You will notice that this is not a “flip a switch and everything is good” exercise, but it also requires effort from the developer to write the code in a way that the compiler can optimize. The goal of this assignment is to learn how to fully exploit the optimization capabilities of the compiler such that in the future when you write code, you write it in a way that gets you the best performance for the least amount of effort.</p><p>Please enter the <code class="language-plaintext highlighter-rouge">part2</code> folder:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>part2
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><h3 id="21-no-auto-vectorization"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#21-no-auto-vectorization" class="anchor-heading" aria-labelledby="21-no-auto-vectorization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.1 No auto-vectorization</h3><p>We will start with the following simple loop (in <code class="language-plaintext highlighter-rouge">test1.c</code>) with no auto-vectorization. Since auto-vectorization is enabled by default at optimization levels <code class="language-plaintext highlighter-rouge">-O2</code> and <code class="language-plaintext highlighter-rouge">-O3</code>, we first use <code class="language-plaintext highlighter-rouge">-fno-vectorize</code> to disable it:</p><div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">test1</span><span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">N</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">__builtin_assume</span><span class="p">(</span><span class="n">N</span> <span class="o">==</span> <span class="mi">1024</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">I</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>We have added an outer loop over <code class="language-plaintext highlighter-rouge">I</code> to eliminate measurement error in <code class="language-plaintext highlighter-rouge">gettime()</code>. Notice that <code class="language-plaintext highlighter-rouge">__builtin_assume(N == 1024)</code> tells the compiler more about the program—say this program always has the same input size—so that it can perform more optimizations.</p><p>You can compile this C++ code fragment with the following command and see the generated assembly code in <code class="language-plaintext highlighter-rouge">assembly/test1.novec.s</code>.</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean<span class="p">;</span> make test1.o <span class="nv">ASSEMBLE</span><span class="o">=</span>1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>You are recommended to try out Compiler Explorer, a nifty online tool that provides an “interactive compiler”. <a href="https://godbolt.org/z/4roc539fx"><u>This link</u></a> is pre-configured for 11.0.1 version of <em>clang</em> and compiler flags from the makefile. (To manually configure yourself: select language C, compiler version x86-64 <em>clang</em> 11.0.1 and enter flags <code class="language-plaintext highlighter-rouge">-O3 -std=c11 -Wall -fno-vectorize -fverbose-asm</code>. A screenshot is shown below.</p><p><img alt="fno-vectorize" src="./Programming Assignment I _ PP-s25_files/screenshot.png"></p><h3 id="22-turning-on-auto-vectorization"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#22-turning-on-auto-vectorization" class="anchor-heading" aria-labelledby="22-turning-on-auto-vectorization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.2 Turning on auto-vectorization</h3><p>Let’s turn on the compiler optimizations and see how much the compiler can speed up the program.</p><p>Remove <code class="language-plaintext highlighter-rouge">-fno-vectorize</code> from the compiler option to turn on the compiler optimizations, and add <code class="language-plaintext highlighter-rouge">-Rpass=loop-vectorize -Rpass-missed=loop-vectorize -Rpass-analysis=loop-vectorize</code> to get more information from <em>clang</em> about why it does or does not optimize code. This was done in the makefile, and you can enable auto-vectorization by typing the following command, which generates <code class="language-plaintext highlighter-rouge">assembly/test1.vec.s</code>.</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean<span class="p">;</span> make test1.o <span class="nv">ASSEMBLE</span><span class="o">=</span>1 <span class="nv">VECTORIZE</span><span class="o">=</span>1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>You should see the following output, informing you that the loop has been vectorized. Although <em>clang</em> does tell you this, you should always look at the assembly to see exactly how it has been vectorized, since it is not guaranteed to be using the vector registers optimally.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test1.c:7:5: remark: vectorized loop (vectorization width: 4, interleaved count: 2) [-Rpass=loop-vectorize]
    for (int j=0; j&lt;N; j++) {
    ^
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>You can observe the difference between <code class="language-plaintext highlighter-rouge">test1.vec.s</code> and <code class="language-plaintext highlighter-rouge">test1.novec.s</code> with the following command or by changing the compiler flag on Compiler Explorer.</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>diff assembly/test1.vec.s assembly/test1.novec.s
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><h3 id="23-adding-the-__restrict-qualifier"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#23-adding-the-__restrict-qualifier" class="anchor-heading" aria-labelledby="23-adding-the-__restrict-qualifier"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.3 Adding the <code class="language-plaintext highlighter-rouge">__restrict</code> qualifier</h3><p>Now, if you inspect the assembly code—actually, you don’t need to do that, which is out of the scope of this assignment—you will see the code first checks if there is a partial overlap between arrays <code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">c</code> or arrays <code class="language-plaintext highlighter-rouge">b</code> and <code class="language-plaintext highlighter-rouge">c</code>. If there is an overlap, then it does a simple non-vectorized code. If there is no overlap, it does a vectorized version. The above can, at best, be called partially vectorized.</p><p>The problem is that the compiler is constrained by what we tell it about the arrays. If we tell it more, then perhaps it can do more optimization. The most obvious thing is to inform the compiler that no overlap is possible. This is done in standard C by using the <code class="language-plaintext highlighter-rouge">restrict</code> qualifier for the pointers. By adding this type qualifier, you can hint to the compiler that for the lifetime of the pointer, only the pointer itself or a value directly derived from it (such as <code class="language-plaintext highlighter-rouge">pointer + 1</code>) will be used to access the object it points to.</p><p>C++ does not have standard support for <code class="language-plaintext highlighter-rouge">restrict</code>, but many compilers have equivalents that work in both C++ and C, such as the <em>GCC</em>’s and <em>clang</em>’s <code class="language-plaintext highlighter-rouge">__restrict__</code> (or <code class="language-plaintext highlighter-rouge">__restrict</code>), and Visual C++’s <code class="language-plaintext highlighter-rouge">__declspec(restrict)</code>.</p><p>The code after adding the <code class="language-plaintext highlighter-rouge">__restrict</code> qualifier is shown as follows.</p><div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">test1</span><span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">a</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">b</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">N</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">__builtin_assume</span><span class="p">(</span><span class="n">N</span> <span class="o">==</span> <span class="mi">1024</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">I</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Let’s modify <code class="language-plaintext highlighter-rouge">test1.c</code> accordingly and recompile it again with the following command, which generates <code class="language-plaintext highlighter-rouge">assembly/test1.vec.restr.s</code>.</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean<span class="p">;</span> make test1.o <span class="nv">ASSEMBLE</span><span class="o">=</span>1 <span class="nv">VECTORIZE</span><span class="o">=</span>1 <span class="nv">RESTRICT</span><span class="o">=</span>1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Now you should see the generated code is better—the code for checking possible overlap is gone—but it is assuming the data are <strong>NOT</strong> 16 bytes aligned (<code class="language-plaintext highlighter-rouge">movups</code> is unaligned move). It also means that the loop above can not assume that the arrays are aligned.</p><p>If <em>clang</em> were smart, it could test for the cases where the arrays are either all aligned, or all unaligned, and have a fast inner loop. However, it is unable to do that currently.🙁</p><h3 id="24-adding-the-__builtin_assume_aligned-intrinsic"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#24-adding-the-__builtin_assume_aligned-intrinsic" class="anchor-heading" aria-labelledby="24-adding-the-__builtin_assume_aligned-intrinsic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.4 Adding the <code class="language-plaintext highlighter-rouge">__builtin_assume_aligned</code> intrinsic</h3><p>To get the performance we are looking for, we need to tell <em>clang</em> that the arrays are aligned. There are a couple of ways to do that. The first is to construct a (non-portable) aligned type and use that in the function interface. The second is to add an alignment hint within the function. The second one is easier to implement on older code bases, as other functions calling the one to be vectorized do not have to be modified. The intrinsic for this is called <code class="language-plaintext highlighter-rouge">__builtin_assume_aligned</code>:</p><div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">test1</span><span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">a</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">b</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">N</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">__builtin_assume</span><span class="p">(</span><span class="n">N</span> <span class="o">==</span> <span class="mi">1024</span><span class="p">);</span>
  <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="p">)</span><span class="n">__builtin_assume_aligned</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
  <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="p">)</span><span class="n">__builtin_assume_aligned</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
  <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="p">)</span><span class="n">__builtin_assume_aligned</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">I</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Let’s modify <code class="language-plaintext highlighter-rouge">test1.c</code> accordingly and recompile it again with the following command, which generates <code class="language-plaintext highlighter-rouge">assembly/test1.vec.restr.align.s</code>.</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean<span class="p">;</span> make test1.o <span class="nv">ASSEMBLE</span><span class="o">=</span>1 <span class="nv">VECTORIZE</span><span class="o">=</span>1 <span class="nv">RESTRICT</span><span class="o">=</span>1 <span class="nv">ALIGN</span><span class="o">=</span>1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Let’s see the difference:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>diff assembly/test1.vec.restr.s assembly/test1.vec.restr.align.s
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Now finally, we get the nice tight vectorized code (<code class="language-plaintext highlighter-rouge">movaps</code> is aligned move.) we were looking for, because <em>clang</em> has used packed <em>SSE</em> instructions to add 16 bytes at a time. It also manages <code class="language-plaintext highlighter-rouge">load</code> and <code class="language-plaintext highlighter-rouge">store</code> two at a time, which it did not do last time. The question is now that we understand what we need to tell the compiler, how complex can the loop be before auto-vectorization fails?</p><h3 id="25-turning-on-avx2-instructions"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#25-turning-on-avx2-instructions" class="anchor-heading" aria-labelledby="25-turning-on-avx2-instructions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.5 Turning on AVX2 instructions</h3><p>Next, we try to turn on AVX2 instructions using the following command, which generates <code class="language-plaintext highlighter-rouge">assembly/test1.vec.restr.align.avx2.s</code></p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean<span class="p">;</span> make test1.o <span class="nv">ASSEMBLE</span><span class="o">=</span>1 <span class="nv">VECTORIZE</span><span class="o">=</span>1 <span class="nv">RESTRICT</span><span class="o">=</span>1 <span class="nv">ALIGN</span><span class="o">=</span>1 <span class="nv">AVX2</span><span class="o">=</span>1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Let’s see the difference:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>diff assembly/test1.vec.restr.align.s assembly/test1.vec.restr.align.avx2.s
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>We can see instructions with the prefix <code class="language-plaintext highlighter-rouge">v*</code>. That’s good. We confirm the compiler uses AVX2 instructions; however, this code is still not aligned when using <em>AVX2</em> registers.</p><blockquote><p><strong><em><a name="Q2-1">Q2-1</a>:</em></strong> Fix the code to make sure it uses aligned moves for the best performance.</p><p>Hint: we want to see <code class="language-plaintext highlighter-rouge">vmovaps</code> rather than <code class="language-plaintext highlighter-rouge">vmovups</code>.</p></blockquote><h3 id="26-performance-impacts-of-vectorization"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#26-performance-impacts-of-vectorization" class="anchor-heading" aria-labelledby="26-performance-impacts-of-vectorization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.6 Performance impacts of vectorization</h3><p>Let’s see what speedup we get from vectorization. Build and run the program with the following configurations, which run <code class="language-plaintext highlighter-rouge">test1()</code> many times, and record the elapsed execution time.</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># case 1</span>
make clean <span class="o">&amp;&amp;</span> make <span class="o">&amp;&amp;</span> run <span class="nt">--</span> ./test_auto_vectorize <span class="nt">-t</span> 1
<span class="c"># case 2</span>
make clean <span class="o">&amp;&amp;</span> make <span class="nv">VECTORIZE</span><span class="o">=</span>1 <span class="o">&amp;&amp;</span> run <span class="nt">--</span> ./test_auto_vectorize <span class="nt">-t</span> 1
<span class="c"># case 3</span>
make clean <span class="o">&amp;&amp;</span> make <span class="nv">VECTORIZE</span><span class="o">=</span>1 <span class="nv">AVX2</span><span class="o">=</span>1 <span class="o">&amp;&amp;</span> run <span class="nt">--</span> ./test_auto_vectorize <span class="nt">-t</span> 1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Note that you may wish to use the workstations provided by this course, which support <em>AVX2</em>; otherwise, you may get a message like “Illegal instruction (core dumped)”. You can check whether or not a machine supports the <em>AVX2</em> instructions by looking for <code class="language-plaintext highlighter-rouge">avx2</code> in the flags section of the output of <code class="language-plaintext highlighter-rouge">cat /proc/cpuinfo</code>.</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>run <span class="nt">--</span> <span class="nb">cat</span> /proc/cpuinfo | <span class="nb">grep </span>avx2
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><blockquote><p><strong><em><a name="Q2-2">Q2-2</a>:</em></strong> What speedup does the vectorized code achieve over the unvectorized code? What additional speedup does using <code class="language-plaintext highlighter-rouge">-mavx2</code> give (<code class="language-plaintext highlighter-rouge">AVX2=1</code> in the <code class="language-plaintext highlighter-rouge">Makefile</code>)? You may wish to run this experiment several times and take median elapsed times; you can report answers to the nearest 100% (e.g., 2×, 3×, etc). What can you infer about the bit width of the default vector registers on the PP machines? What about the bit width of the <em>AVX2</em> vector registers?</p><p>Hint: Aside from speedup and the vectorization report, the most relevant information is that the data type of each array is <code class="language-plaintext highlighter-rouge">float</code>.</p></blockquote><p>You may also run <code class="language-plaintext highlighter-rouge">test2()</code> and <code class="language-plaintext highlighter-rouge">test3()</code> with <code class="language-plaintext highlighter-rouge">run -- ./test_auto_vectorize -t 2</code> and <code class="language-plaintext highlighter-rouge">run -- ./test_auto_vectorize -t 3</code>, respectively, before and after fixing the vectorization issues in Section 2.7.</p><h3 id="27--more-examples"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#27--more-examples" class="anchor-heading" aria-labelledby="27--more-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.7 More examples</h3><h4 id="271-example-2"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#271-example-2" class="anchor-heading" aria-labelledby="271-example-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.7.1 Example 2</h4><p>Take a look at the second example below in <code class="language-plaintext highlighter-rouge">test2.c</code>:</p><div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kt">void</span> <span class="nf">test2</span><span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">a</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">b</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">N</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">__builtin_assume</span><span class="p">(</span><span class="n">N</span> <span class="o">==</span> <span class="mi">1024</span><span class="p">);</span>
  <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="p">)</span><span class="n">__builtin_assume_aligned</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
  <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="p">)</span><span class="n">__builtin_assume_aligned</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
  <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="p">)</span><span class="n">__builtin_assume_aligned</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">I</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="cm">/* max() */</span>
      <span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Compile the code with the following command:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean<span class="p">;</span> make test2.o <span class="nv">ASSEMBLE</span><span class="o">=</span>1 <span class="nv">VECTORIZE</span><span class="o">=</span>1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Note that the assembly was not vectorized. Now, change the function with a patch file (<code class="language-plaintext highlighter-rouge">test2.c.patch</code>), which is shown below, by running <code class="language-plaintext highlighter-rouge">patch -i ./test2.c.patch</code>.</p><div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- test2.c
</span><span class="gi">+++ test2.c
</span><span class="p">@@ -14,9 +14,8 @@</span>
     for (int j = 0; j &lt; N; j++)
     {
       /* max() */
<span class="gd">-      c[j] = a[j];
-      if (b[j] &gt; a[j])
-        c[j] = b[j];
</span><span class="gi">+      if (b[j] &gt; a[j]) c[j] = b[j];
+      else c[j] = a[j];
</span>     }
   }

</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Now, you can see the vectorized assembly with the <code class="language-plaintext highlighter-rouge">movaps</code> and <code class="language-plaintext highlighter-rouge">maxps</code> instructions.</p><blockquote><p><strong><em><a name="Q2-3">Q2-3</a>:</em></strong> Provide a theory for why the compiler is generating dramatically different assemblies.</p></blockquote><h4 id="272-example-3"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#272-example-3" class="anchor-heading" aria-labelledby="272-example-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.7.2 Example 3</h4><p>Take a look at the third example below in <code class="language-plaintext highlighter-rouge">test3.c</code>:</p><div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">double</span> <span class="nf">test3</span><span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="kr">__restrict</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">N</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">__builtin_assume</span><span class="p">(</span><span class="n">N</span> <span class="o">==</span> <span class="mi">1024</span><span class="p">);</span>
  <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="p">)</span><span class="n">__builtin_assume_aligned</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>

  <span class="kt">double</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">I</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">b</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Compile the code with the following command:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean<span class="p">;</span> make test3.o <span class="nv">ASSEMBLE</span><span class="o">=</span>1 <span class="nv">VECTORIZE</span><span class="o">=</span>1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>You should see the non-vectorized code with the <code class="language-plaintext highlighter-rouge">addsd</code> instructions.</p><p>Notice that this is not vectorization as the <em>xmm</em> registers are operating only on 8-byte chunks. The problem here is that <em>clang</em> is not allowed to re-order the operations we give it. Even though addition is associative over real numbers, they aren’t associative over floating point numbers. (Consider computers can’t express floating point numbers precisely, leading to errors in calculations.)</p><p>Furthermore, we need to tell <em>clang</em> that reordering operations is okay with us. To do this, we need to add another compile-time flag, <code class="language-plaintext highlighter-rouge">-ffast-math</code>. Compile the program again with the following command:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean<span class="p">;</span> make test3.o <span class="nv">ASSEMBLE</span><span class="o">=</span>1 <span class="nv">VECTORIZE</span><span class="o">=</span>1 <span class="nv">FASTMATH</span><span class="o">=</span>1
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>You should see the vectorized code with the <code class="language-plaintext highlighter-rouge">addpd</code> instructions.</p><h2 id="3-requirements"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#3-requirements" class="anchor-heading" aria-labelledby="3-requirements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Requirements</h2><p>You will need to meet the following requirements and answer the questions (marked with “<strong>Q1</strong> &amp; <strong>Q2</strong>”) in a <strong>REPORT</strong> using <a href="https://hackmd.io/">HackMD</a>. (Markdown is a common format that is widely used for developer documentation (e.g., GitHub), and HackMD is a free markdown service, powerful, and most importantly made in Taiwan. To learn Markdown, you may refer to the video listed in the <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#7-references">references</a>.)</p><h3 id="31-part-1"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#31-part-1" class="anchor-heading" aria-labelledby="31-part-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1 Part 1</h3><ol><li>Implement a vectorized version of <code class="language-plaintext highlighter-rouge">clampedExpSerial</code> in <code class="language-plaintext highlighter-rouge">clampedExpVector</code> within <code class="language-plaintext highlighter-rouge">vectorOP.cpp</code> (using fake vector intrinsics). Your implementation should work with any combination of input array size (<code class="language-plaintext highlighter-rouge">N</code>) and vector width (<code class="language-plaintext highlighter-rouge">VECTOR_WIDTH</code>), achieve a <strong>vector utilization higher than 60%</strong>, and of course <strong>pass the verification</strong>. (You can assume the array size is much bigger than the vector width.)</li><li><p>Run <code class="language-plaintext highlighter-rouge">run -- ./myexp -s 10000</code> and sweep the vector width from 2, 4, 8, to 16. Record the resulting vector utilization. You can do this by changing the <code class="language-plaintext highlighter-rouge">#define VECTOR_WIDTH</code> value in <code class="language-plaintext highlighter-rouge">def.h</code>. <strong>Q1-1</strong>: Does the vector utilization increase, decrease or stay the same as <code class="language-plaintext highlighter-rouge">VECTOR_WIDTH</code> changes? Why?</p></li><li><strong>Bonus</strong>: Implement a vectorized version of <code class="language-plaintext highlighter-rouge">arraySumSerial</code> in <code class="language-plaintext highlighter-rouge">arraySumVector</code> within <code class="language-plaintext highlighter-rouge">vectorOP.cpp</code>. Your implementation may assume that <code class="language-plaintext highlighter-rouge">VECTOR_WIDTH</code> is an even number and is a factor of the input array size <code class="language-plaintext highlighter-rouge">N</code>. Whereas the serial implementation has <code class="language-plaintext highlighter-rouge">O(N)</code> work-span, your implementation should have at most <code class="language-plaintext highlighter-rouge">O(N / VECTOR_WIDTH + log2(VECTOR_WIDTH))</code> span. You should achieve a vector utilization higher than 80% and pass the verification. You may find the <code class="language-plaintext highlighter-rouge">hadd</code> and <code class="language-plaintext highlighter-rouge">interleave</code> operations useful. (You can assume the array size is much bigger than the vector width.)</li></ol><h3 id="32-part-2"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#32-part-2" class="anchor-heading" aria-labelledby="32-part-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.2 Part 2</h3><p>Answer the three questions (<a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#Q2-1">Q2-1</a>, <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#Q2-2">Q2-2</a>, and <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#Q2-3">Q2-3</a>) embedded in part 2. We don’t test your code. If you have code for answering the questions, show the code and explain it thoroughly in your report.</p><h2 id="4-grading-policy"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#4-grading-policy" class="anchor-heading" aria-labelledby="4-grading-policy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Grading Policy</h2><p><strong>NO CHEATING!!</strong> You will receive no credit if you are found cheating.</p><p>Total of 110%:</p><ul><li>Part 1 (80%):<ul><li>Correctness (60%): A correct implementation of <code class="language-plaintext highlighter-rouge">clampedExpVector</code>. The <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#3-requirements">requirements</a> should be met. Notice that you will receive <strong>no credit</strong> if any of the requirements fails.</li><li>Question (10%): <code class="language-plaintext highlighter-rouge">Q1-1</code> contributes 10%. Answers to the question will be classified into one of the four reward tiers: excellent (10%), good (7%), normal (3%), and terrible (0%).</li><li>Bonus (10%): A correct implementation of <code class="language-plaintext highlighter-rouge">arraySumVector</code>. The <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#3-requirements">requirements</a> should be met. Notice that you will receive <strong>no credit</strong> if any of the requirements fails.</li></ul></li><li>Part 2 (30%)<ul><li>Questions: For <code class="language-plaintext highlighter-rouge">Q2-1</code>~<code class="language-plaintext highlighter-rouge">Q2-3</code>, each question contributes 10%. Answers to each question will be classified into one of the four reward tiers: excellent (10%), good (7%), normal (3%), and terrible (0%).</li></ul></li></ul><h2 id="5-evaluation-platform"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#5-evaluation-platform" class="anchor-heading" aria-labelledby="5-evaluation-platform"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5. Evaluation Platform</h2><p>Your program should be able to run on UNIX-like OS platforms. We will evaluate your programs on the dedicated workstations. The workstations are based on Debian 12.9 with Intel(R) Core(TM) i5-10500 CPU @ 3.10GHz processors and GeForce GTX 1060 6GB. <code class="language-plaintext highlighter-rouge">g++-12</code>, <code class="language-plaintext highlighter-rouge">clang++-11</code>, and <code class="language-plaintext highlighter-rouge">CUDA 12.5.1</code> have been installed.</p><h2 id="6-submission"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#6-submission" class="anchor-heading" aria-labelledby="6-submission"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 6. Submission</h2><p>All your files should be organized in the following hierarchy and zipped into a <code class="language-plaintext highlighter-rouge">.zip</code> file, named <code class="language-plaintext highlighter-rouge">HW1_xxxxxxx.zip</code>, where <code class="language-plaintext highlighter-rouge">xxxxxxx</code> is your student ID.</p><p>Directory structure inside the zipped file:</p><ul><li><code class="language-plaintext highlighter-rouge">HW1_xxxxxxx.zip</code> (root)<ul><li><code class="language-plaintext highlighter-rouge">vectorOP.cpp</code></li><li><code class="language-plaintext highlighter-rouge">url.txt</code></li></ul></li></ul><p>Zip the file:</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zip HW1_xxxxxxx.zip vectorOP.cpp url.txt
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><p>Notice that you just need to provide the URL of your HackMD report in <code class="language-plaintext highlighter-rouge">url.txt</code>, and enable the write permission for someone who knows the URL so that TAs can give you feedback directly in your report.</p><p><strong>Please run the provided testing script <code class="language-plaintext highlighter-rouge">test_hw1</code> before submitting your assignment.</strong></p><p>Run <code class="language-plaintext highlighter-rouge">test_hw1</code> in a directory that contains your <code class="language-plaintext highlighter-rouge">HW1_XXXXXXX.zip</code> file on the workstation. <code class="language-plaintext highlighter-rouge">test_hw1</code> checks if the ZIP hierarchy is correct and runs graders to check your answer, although <em>for reference only</em>. It automatically starts the workloads on the compute node, so <code class="language-plaintext highlighter-rouge">run</code> is not needed.</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test_hw1 &lt;your_student_id&gt;
</code></pre></div><button type="button" aria-label="Copy code to clipboard"><svg viewBox="0 0 24 24" class="copy-icon"><use xlink:href="#svg-copy"></use></svg></button></div><blockquote class="note"><ul><li>It may take a few minutes to complete the testing.</li></ul></blockquote><p>Be sure to upload your zipped file to the new E3 e-Campus system by the due date.</p><p><strong>You will get <em>NO POINT</em> if your ZIP’s name is wrong or the ZIP hierarchy is incorrect.</strong></p><p><strong>You will get a 5-point penalty if you hand out unnecessary files (e.g., obj files, .vscode, .__MACOSX).</strong></p><h2 id="7-references"> <a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#7-references" class="anchor-heading" aria-labelledby="7-references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 7. References</h2><ul><li><a href="https://en.wikipedia.org/wiki/Analysis_of_parallel_algorithms">Wikipedia: Analysis of parallel algorithms</a></li><li><a href="https://en.wikipedia.org/wiki/SIMD">Wikipedia: SIMD</a></li><li><a href="https://clang.llvm.org/docs/LanguageExtensions.html#builtin-functions">Clang: built-in functions document</a></li><li><a href="https://slurm.schedmd.com/documentation.html">Slurm Workload Manager: Documentation</a></li><li><a href="https://www.youtube.com/watch?v=Or6adjo3W4E&amp;list=PLCOCSTovXmudP_dZi1T9lNHLOtqpK9e2P&amp;index=19">Video: Markdown 使用教學</a></li><li><a href="https://www.youtube.com/watch?v=PYdM2vN4BpE&amp;list=PLCOCSTovXmudP_dZi1T9lNHLOtqpK9e2P&amp;index=15">Video: SSH &amp; SCP 使用教學</a></li></ul><hr><footer><p class="text-small text-grey-dk-100 mb-0"><a href="https://nycu-sslab.github.io/PP-s25/assignments/HW1/#top">Back to top</a><br><br>This website is built using <a href="https://kevinl.info/just-the-class/">Kevin Lin's Just the Class</a> Jekyll template. <script type="text/javascript" src="./Programming Assignment I _ PP-s25_files/MathJax.js.下載" async=""> </script> <script type="text/x-mathjax-config;executed=true"> MathJax.Hub.Config({'HTML-CSS': { preferredFont: 'TeX', availableFonts: ['STIX','TeX'], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) }, tex2jax: { inlineMath: [ ['$', '$'] ], processEscapes: true, ignoreClass: 'tex2jax_ignore|dno',skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']}, TeX: { noUndefined: { attributes: { mathcolor: 'red', mathbackground: '#FFEEEE', mathsize: '90%' } }, Macros: { href: '{}' } }, messageStyle: 'none' }); MathJax.Hub.Queue(function() { var all = MathJax.Hub.getAllJax(), i; for(i=0; i < all.length; i += 1) { all[i].SourceElement().parentNode.className += ' has-jax'; } }); </script></p></footer></div></div><div class="search-overlay"></div></div>
</body></html>